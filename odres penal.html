<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zenvora - Orders Admin Panel</title>
<style>
    body { font-family: Arial, sans-serif; background: #f5f5f5; padding: 20px; }
    h1 { text-align: center; color: #333; }
    .container { max-width: 1150px; margin: auto; background: white; padding: 20px; border-radius: 10px; }
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 10px; border: 1px solid #ddd; vertical-align: top; }
    th { background: #ff6f00; color: white; }
    .product { display: flex; align-items: center; margin-bottom: 5px; }
    .product img { width: 50px; height: 50px; object-fit: cover; border-radius: 5px; margin-right: 8px; }
    .delete-btn { background: red; color: white; padding: 5px 10px; border: none; border-radius: 5px; cursor: pointer; }
    .delete-btn:hover { background: darkred; }
    .no-orders { text-align: center; color: #777; padding: 20px; }
    select { padding: 5px; border-radius: 5px; }
</style>
</head>
<body>

<h1>üì¶ Zenvora - Orders Admin Panel</h1>
<div class="container">
    <table>
        <thead>
            <tr>
                <th>Order ID</th>
                <th>Customer Details</th>
                <th>Products</th>
                <th>Items</th>
                <th>Total Price</th>
                <th>Status</th>
                <th>Date</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="ordersBody">
            <tr><td colspan="8" class="no-orders">No orders found</td></tr>
        </tbody>
    </table>
</div>

<script>
    let orders = JSON.parse(localStorage.getItem('orders')) || [];
    const ordersBody = document.getElementById('ordersBody');

    function generateOrderID(index) {
        return "ORD-" + (1000 + index);
    }

    function renderOrders() {
        ordersBody.innerHTML = '';

        if (orders.length === 0) {
            ordersBody.innerHTML = `<tr><td colspan="8" class="no-orders">No orders found</td></tr>`;
            return;
        }

        orders.forEach((order, index) => {
            // ‡§Ö‡§ó‡§∞ orderId ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à ‡§§‡•ã ‡§ú‡§®‡§∞‡•á‡§ü ‡§ï‡§∞‡§ï‡•á ‡§∏‡•á‡§µ ‡§ï‡§∞ ‡§¶‡•ã
            if (!order.orderId) {
                order.orderId = generateOrderID(index + 1);
            }
            // ‡§Ö‡§ó‡§∞ status ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à ‡§§‡•ã default "Pending"
            if (!order.status) {
                order.status = "Pending";
            }

            let productsHTML = '';
            let totalQty = 0;

            order.cart.forEach(p => {
                totalQty += p.qty;
                productsHTML += `
                    <div class="product">
                        <img src="${p.img}" alt="${p.title}">
                        <span>${p.title} (x${p.qty}) - ‚Çπ${p.price * p.qty}</span>
                    </div>
                `;
            });

            ordersBody.innerHTML += `
                <tr>
                    <td><b>${order.orderId}</b></td>
                    <td>
                        <b>${order.customer.fullname}</b><br>
                        üìß ${order.customer.email}<br>
                        üì± ${order.customer.mobile}<br>
                        üè† ${order.customer.address}, ${order.customer.city}, ${order.customer.state} - ${order.customer.pincode}
                    </td>
                    <td>${productsHTML}</td>
                    <td>${order.cart.length} Products<br>(${totalQty} Items)</td>
                    <td>‚Çπ${order.total}</td>
                    <td>
                        <select onchange="updateStatus(${index}, this.value)">
                            <option value="Pending" ${order.status === "Pending" ? "selected" : ""}>Pending</option>
                            <option value="Processing" ${order.status === "Processing" ? "selected" : ""}>Processing</option>
                            <option value="Shipped" ${order.status === "Shipped" ? "selected" : ""}>Shipped</option>
                            <option value="Delivered" ${order.status === "Delivered" ? "selected" : ""}>Delivered</option>
                            <option value="Cancelled" ${order.status === "Cancelled" ? "selected" : ""}>Cancelled</option>
                        </select>
                    </td>
                    <td>${order.date}</td>
                    <td><button class="delete-btn" onclick="deleteOrder(${index})">Delete</button></td>
                </tr>
            `;
        });

        // ‡§∏‡•á‡§µ ‡§ï‡§∞ ‡§¶‡•ã ‡§§‡§æ‡§ï‡§ø ID ‡§î‡§∞ status ‡§™‡§ï‡•ç‡§ï‡•Ä ‡§∞‡§π‡•á
        localStorage.setItem('orders', JSON.stringify(orders));
    }

    function updateStatus(index, newStatus) {
        orders[index].status = newStatus;
        localStorage.setItem('orders', JSON.stringify(orders));
        alert("Order status updated to " + newStatus);
    }

    function deleteOrder(index) {
        if (confirm("Delete this order?")) {
            orders.splice(index, 1);
            localStorage.setItem('orders', JSON.stringify(orders));
            renderOrders();
        }
    }

    renderOrders();
</script>

</body>
</html>
